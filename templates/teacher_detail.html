{% extends "base.html" %} {% block title %}{{_('Teacher')}}{% endblock %}{%
block content %}
<h1>{{ professor.full_name }}</h1>
<img
    src="{{ 'https://avesis.yildiz.edu.tr/user/image/'+professor.image_id }}"
    alt="{{ professor.full_name }}"
    width="200"
/>

<h2>{{_('Teacher Rating')}}</h2>
<p>
    {{_('English Proficiency')}}: {{ "%.1f"|format(avg_ratings.avg_english if
    avg_ratings.avg_english is not none else 0) }}
</p>
<p>
    {{_('Friendliness')}}: {{ "%.1f"|format(avg_ratings.avg_friendliness if
    avg_ratings.avg_friendliness is not none else 0) }}
</p>
<p>
    {{_('Knowledge')}}: {{ "%.1f"|format(avg_ratings.avg_knowledge if
    avg_ratings.avg_knowledge is not none else 0) }}
</p>

{% if user %}
<h2>{{_('Rate this Teachers')}}</h2>
<form action="/teachers/{{ professor.id }}/rate" method="post">
    {% if user.verified %}
    <div class="form-group">
        <label for="comment">{{_('Comment')}}</label>
        <textarea class="form-control" id="comment" name="comment">
{{ user_rating.comment if user_rating else '' }}</textarea
        >
    </div>
    {% else %}
    <p>{{_('You must be a verified user to leave a comment.')}}</p>
    {% endif %}
    <div class="form-group">
        <label for="english_proficiency">{{_('English Proficiency')}}</label>
        <input
            type="number"
            class="form-control"
            id="english_proficiency"
            name="english_proficiency"
            min="5"
            max="50"
            step="5"
            required
            value="{{ user_rating.english_proficiency if user_rating else 25 }}"
        />
    </div>
    <div class="form-group">
        <label for="friendliness">{{_('Friendliness')}}</label>
        <input
            type="number"
            class="form-control"
            id="friendliness"
            name="friendliness"
            min="5"
            max="50"
            step="5"
            required
            value="{{ user_rating.friendliness if user_rating else 25 }}"
        />
    </div>
    <div class="form-group">
        <label for="knowledge">{{_('Knowledge')}}</label>
        <input
            type="number"
            class="form-control"
            id="knowledge"
            name="knowledge"
            min="5"
            max="50"
            step="5"
            required
            value="{{ user_rating.knowledge if user_rating else 25 }}"
        />
    </div>
    <button type="submit" class="btn btn-primary">
        {{_('Submit Rating')}}
    </button>
</form>
{% else %}
<p>
    {{_('Please')}}
    <a href="#" onclick="openLoginPopup()">{{_('login')}}</a> {{_('to rate this
    teacher')}}.
</p>
{% endif %} {% for rating in ratings %}
<div class="card mb-3">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-start">
            <p class="card-text">{{ rating.comment }}</p>
            <div>
                {% if rating.user.verified %}
                <span class="badge bg-success">{{_('Verified Student')}}</span>
                {% elif user and user.id == rating.user_id %}
                <a href="/verify" class="badge bg-warning text-dark"
                    >{{_('Verify Account')}}</a
                >
                {% else %}
                <span class="badge bg-secondary">{{_('Unverified')}}</span>
                {% endif %} {% if user and (user.id == rating.user_id or
                user.admin == true) %}
                <form
                    action="/teachers/{{ professor.id }}/ratings/{{ rating.id }}/delete"
                    method="post"
                    style="display: inline"
                >
                    <button
                        type="submit"
                        class="btn btn-sm btn-danger"
                        onclick="return confirm('{{_('Are you sure you want to delete your rating?')}}')"
                    >
                        {{_('Delete')}}
                    </button>
                </form>
                {% endif %}
            </div>
        </div>
        <p class="card-text">
            {{_('English Proficiency')}}: {{ rating.english_proficiency }}
        </p>
        <p class="card-text">
            {{_('Friendliness')}}: {{ rating.friendliness }}
        </p>
        <p class="card-text">{{_('Knowledge')}}: {{ rating.knowledge }}</p>
        <p class="card-text">
            <small class="text-muted"
                >{{_('Rated on')}} {{ rating.created_at.strftime('%Y-%m-%d
                %H:%M:%S') }}</small
            >
        </p>
    </div>
</div>
{% endfor %} {% endblock %}
